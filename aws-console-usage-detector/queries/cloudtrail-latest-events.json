{
  "name": "cloudtrail-latest-events",
  "text": "What is the most recent CloudTrail event data available?",
  "query_type": "snowflake_sql",
  "query": "SELECT \n    MAX(EVENTTIME) as most_recent_event,\n    MIN(EVENTTIME) as oldest_event,\n    COUNT(*) as total_events,\n    COUNT(DISTINCT EVENTNAME) as unique_event_types\nFROM SAMPLE_DATABASE.SAMPLE_SCHEMA.SAMPLE_CLOUDTRAIL_TABLE\nWHERE EVENTTIME >= DATEADD(hour, -1, CURRENT_TIMESTAMP())",
  "status": "private",
  "meta": {
    "sql_description": "Show CloudTrail event summary statistics (most recent, oldest, total count, and unique event types) for events within the last {lookback_hours} hours",
    "sql_flow_diagram": "flowchart TD\n    Q[\"Question: What is the most recent CloudTrail event data available?\"]\n    T1[(\"SAMPLE_DATABASE.SAMPLE_SCHEMA.SAMPLE_CLOUDTRAIL_TABLE\")]\n    F1{\"Filter: EVENTTIME >= DATEADD(hour, -1, CURRENT_TIMESTAMP())\"}\n    AGG{\"Aggregations:<br/>MAX(EVENTTIME)<br/>MIN(EVENTTIME)<br/>COUNT(*)<br/>COUNT(DISTINCT EVENTNAME)\"}\n    R[\"Result:<br/>- Most Recent Event<br/>- Oldest Event (last hour)<br/>- Total Events<br/>- Unique Event Types\"]\n    \n    Q --> T1\n    T1 --> F1\n    F1 --> AGG\n    AGG --> R",
    "sql_placeholders": [
      {
        "name": "lookback_hours",
        "original_value": "-1",
        "type": "int"
      }
    ],
    "sql_template": "SELECT \n    MAX(EVENTTIME) as most_recent_event,\n    MIN(EVENTTIME) as oldest_event,\n    COUNT(*) as total_events,\n    COUNT(DISTINCT EVENTNAME) as unique_event_types\nFROM SAMPLE_DATABASE.SAMPLE_SCHEMA.SAMPLE_CLOUDTRAIL_TABLE\nWHERE EVENTTIME >= DATEADD(hour, ?, CURRENT_TIMESTAMP())"
  },
  "datasource_name": "snowflake",
  "type": "snowflake"
}